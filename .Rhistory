cfg$paths$gdx_dir
unlink(file.path(cfg$paths$outputs, "derived"), recursive = TRUE, force = TRUE)
unlink(file.path(cfg$paths$outputs, "base"),    recursive = TRUE, force = TRUE)
run_pipeline()
library(fidelioDiagnostics)
fidelioDiagnostics::launch_app("diagnostic", project_root = getwd())
fidelioDiagnostics::launch_app("results", project_root = getwd())
devtools::document()
devtools::load_all()
devtools::document()
devtools::install()
library(fidelioDiagnostics)
fidelioDiagnostics::run_pipeline()
getAnywhere("export_results_csv")
devtools::document(); devtools::load_all()
getAnywhere("export_results_csv")
"export_results_csv" %in% getNamespaceExports("fidelioDiagnostics")
od <- fidelioDiagnostics:::outputs_dir_from_config()
od
list.files(od, recursive = TRUE, pattern = "results_bundle|template|csv", full.names = TRUE)
bun <- file.path(od, "bundle_results_app.rds")
cfg <- fidelioDiagnostics:::load_config()
str(cfg$export_csv)
fidelioDiagnostics::export_results_csv(cfg = cfg)
Q   # (capital Q) to exit the debugger
getwd()
# 2) Load config explicitly (this should now succeed)
cfg <- fidelioDiagnostics:::load_config()
str(cfg$paths)          # sanity check you see lists, not NULL/strings
library(fidelioDiagnostics)
# 1) Load config and print paths
cfg <- load_config()
print_runtime_info(cfg)
res <- run_pipeline()
str(cfg$paths)
od <- fidelioDiagnostics:::outputs_dir_from_config(cfg)
file.exists(file.path(od, "bundle_results_app.rds"))
# 1) Use the outputs path from cfg directly
cfg <- fidelioDiagnostics:::load_config()
# This is the folder where bundles + derived files live:
od <- file.path(cfg$paths$outputs, "derived")
od
dir.exists(od) || dir.create(od, recursive = TRUE)
bun <- file.path(od, "bundle_results_app.rds")
bun; file.exists(bun)
fidelioDiagnostics::export_results_csv(cfg = cfg)
vlibrary(fidelioDiagnostics)
library(fidelioDiagnostics)
# 1) Load config and print paths
cfg <- load_config()
devtools::document()
devtools::load_all()
cfg <- fidelioDiagnostics:::load_config()
fidelioDiagnostics::export_results_csv(cfg = cfg)
q
cfg <- fidelioDiagnostics::load_config()
root <- "C:/Users/Rocchi/CMCC Dropbox/Paola Rocchi/SPAGHETTI/FIDELIO coupling materials/2025/090925_investments_diagnostic/fidelioDiagnostic"
setwd(root)
# sanity: these must be TRUE
file.exists("config/default.yml"); file.exists("config/project.yml")
# 2) Load config now that we’re in the right folder
cfg <- fidelioDiagnostics:::load_config()
str(cfg$paths)   # should show a list with gdx_dir, outputs, cache
library(yaml)
def <- yaml::read_yaml("config/default.yml")
prj <- yaml::read_yaml("config/project.yml")
# print top-level keys that have a type clash
check_types <- function(x, y, path="") {
bad <- character()
for (nm in intersect(names(x), names(y))) {
px <- paste0(path, nm)
if (is.list(x[[nm]]) && is.list(y[[nm]])) {
bad <- c(bad, check_types(x[[nm]], y[[nm]], paste0(px, ".")))
} else if (is.list(x[[nm]]) != is.list(y[[nm]])) {
bad <- c(bad, px)
}
}
bad
}
clashes <- check_types(def, prj)
clashes
devtools::document()
devtools::load_all()
cfg <- load_config()
# 2) Run the pipeline: extract → wide → aggregates → derived → save
res <- run_pipeline()
library(data.table)
p <- file.path(cfg$paths$outputs, "derived", "results_bundle_template.csv")
DT <- fread(p)
DT[variable != "" & !is.na(variable)][1:10]
DT[variable == "" | is.na(variable)][, .N]  # should be 0
unique(DT[grepl("^GDPr", variable), unit])  # should be "million EUR"
devtools::document()
devtools::load_all()
cfg <- load_config()
# 2) Run the pipeline: extract → wide → aggregates → derived → save
res <- run_pipeline()
source("C:/Users/Rocchi/CMCC Dropbox/Paola Rocchi/SPAGHETTI/FIDELIO coupling materials/2025/090925_investments_diagnostic/fidelioDiagnostic/R/R2csv.R")
devtools::document()
rm(list = "export_results_csv")
library(fidelioDiagnostics)
# make sure R2csv.R is saved under your package's R/ folder
devtools::document()
devtools::load_all()   # this loads the PACKAGE version
# sanity: confirm only the package version exists
getAnywhere("export_results_csv")$where
# run it
cfg <- fidelioDiagnostics:::load_config()
fidelioDiagnostics::export_results_csv(cfg = cfg)   # use :: now that it’s exported
devtools::check()                        # optional but recommended
library(fidelioDiagnostics)
devtools::load_all()
devtools::document()
devtools::build_readme()
warnings()
devtools::build_readme()
library(fidelioDiagnostics)
devtools::build_readme()
library(fidelioDiagnostics)
cfg <- load_config()
launch_app("results")
library(fidelioDiagnostics)
cfg <- load_config()
devtools::document()
devtools::load_all()
cfg <- load_config()
# if you changed roxygen tags (e.g., @export), do this once:
devtools::document()
# load all R/ files and register exports
devtools::load_all()
export_results_csv()
export_results_csv()
library(fidelioDiagnostics)
library(gdxrrw)
# Load configuration and print paths
cfg <- load_config()
launch_app("results")
R.version
library(fidelioDiagnostics)
# keep a console open at the package root
devtools::document()   # only when roxygen/exports changed
devtools::load_all()
devtools::build_readme()
devtools::build_readme()
devtools::build_readme()
devtools::build_readme()
devtools::document()
devtools::install(upgrade = "never", dependencies = FALSE, build_vignettes = FALSE)
library(fidelioDiagnostics)
cfg <- load_config()
launch_app("results")
devtools::load_all()
launch_app("results")
launch_app("results")
devtools::load_all()
launch_app("diagnostic")
launch_app("diagnostic")
devtools::load_all()
launch_app("diagnostic")
devtools::load_all()
launch_app("diagnostic")
devtools::load_all()
launch_app("results")
launch_app("results")
launch_app("diagnostic")
launch_app("diagnostic")
bund <- fidelioDiagnostics:::load_bundle("outputs/derived/bundle_diagnostic_app_ff55_3scn_2025-10-20_11-28-24.rds")  # adjust path
getwd()
bund <- fidelioDiagnostics:::load_bundle("derived/bundle_diagnostic_app_ff55_3scn_2025-10-20_11-28-24.rds")  # adjust path
bund <- fidelioDiagnostics:::load_bundle("bundle_diagnostic_app_ff55_3scn_2025-10-20_11-28-24.rds")  # adjust path
bund <- readRDS(file.choose())
bund <- readRDS("outputs/derived/bundle_diagnostic_app_ff55_3scn_2025-10-20_11-28-24.rds")
names(bund)
obj <- bund[["TB_GDP_t"]]   # this should be “Trade balance to GDP ratio”
class(obj); names(obj)
utils::head(obj)
summary(obj$value)
tb <- bund[["TB_t"]]
class(tb); names(tb)
utils::head(tb)
summary(tb[, .(baseline, ff55, ff55_2)])
devtools::load_all()
cfg <- load_config()
res <- run_pipeline()
devtools::load_all()
cfg <- load_config()
res <- run_pipeline()
devtools::load_all()
res <- run_pipeline()
devtools::load_all()
res <- run_pipeline()
devtools::install(upgrade = "never", dependencies = FALSE, build_vignettes = FALSE)
library(fidelioDiagnostics)
library(fidelioDiagnostics)
cfg <- load_config()
cfg <- load_config()
res <- run_pipeline()
library(fidelioDiagnostics)
run_pipeline()
devtools::install(upgrade = "never", dependencies = FALSE, build_vignettes = FALSE)
library(fidelioDiagnostics)
run_pipeline()
devtools::install(upgrade = "never", dependencies = FALSE, build_vignettes = FALSE)
library(fidelioDiagnostics)
cfg <- load_config()
res <- run_pipeline()
library(data.table)
bundles <- list.files(file.path("outputs","derived"),
pattern="^bundle_diagnostic_app_.*\\.rds$", full.names=TRUE)
bund <- readRDS(tail(bundles, 1))
names(bund)
bundles <- list.files(file.path("outputs","derived"),
+                       pattern="^resuls_by_symbol_.*\\.rds$", full.names=TRUE)
bundles <- list.files(file.path("outputs","derived"), pattern="^resuls_by_symbol_.*\\.rds$", full.names=TRUE)
bund <- readRDS(tail(bundles, 1))
library(data.table)
bundles <- list.files(file.path("outputs","derived"),
pattern="^bundle_diagnostic_app_.*\\.rds$", full.names=TRUE)
bundles <- list.files(file.path("outputs","derived"), pattern="^results_by_symbol_.*\\.rds$", full.names=TRUE)
bund <- readRDS(tail(bundles, 1))
names(bound)
names(bund)
devtools::install(upgrade = "never", dependencies = FALSE, build_vignettes = FALSE)
library(fidelioDiagnostics)
cfg <- load_config()
res <- run_pipeline()
launch_app("diagnostic")
devtools::install_deps(dependencies = TRUE)
devtools::install(upgrade = "never", dependencies = FALSE, build_vignettes = FALSE)
library(fidelioDiagnostics)
cfg <- load_config()
res <- run_pipeline()
launch_app("diagnostic")
launch_app("results")
getwd()
launch_app("results")
getwd()
fidelioDiagnostics:::load_config()
launch_app("results")
devtools::document()
devtools::install(upgrade = "never", dependencies = FALSE, build_vignettes = FALSE)
library(fidelioDiagnostics)
cfg <- load_config()
launch_app("results")
devtools::load_all()
launch_app("results")
fidelioDiagnostics::launch_app("results")
install.packages("devtools")
fidelioDiagnostics::launch_app("results")
devtools::load_all()
launch_app("results")
devtools::install(upgrade = "never", dependencies = FALSE, build_vignettes = FALSE)
library(fidelioDiagnostics)
cfg <- load_config()
library(fidelioDiagnostics)
cfg <- load_config()
launch_app("results")
devtools::load_all()
launch_app("results")
devtools::load_all()
launch_app("results")
devtools::load_all()
launch_app("results")
library(fidelioDiagnostics)
cfg <- load_config()
devtools::load_all()
launch_app("results")
devtools::load_all()
launch_app("results")
launch_app("diagnostic")
q
q
q
library(fidelioDiagnostics)
cfg <- load_config()
devtools::load_all()
launch_app("diagnostic")
library(fidelioDiagnostics)
cfg <- load_config()
devtools:: load_all()
launch_app("diagnostic")
devtools:: load_all()
launch_app("diagnostic")
devtools:: load_all()
launch_app("diagnostic")
devtools::install(upgrade = "never", dependencies = FALSE, build_vignettes = FALSE)
library(fidelioDiagnostics)
cfg <- load_config()
launch_app("diagnostic")
devtools:::load_all()
launch_app("diagnostic")
library(readxl)
file <- "C:/Users/Rocchi/CMCC Dropbox/Paola Rocchi/PC/Desktop/work/Administrative/strategic_overview/output/strategic_overview.xlsx"
# Elenco fogli
sheets <- excel_sheets(file)
# Estrai colonne da ciascun foglio
info_list <- lapply(sheets, function(s) {
df <- read_excel(file, sheet = s, n_max = 0) # leggi solo intestazioni
data.frame(sheet = s, columns = names(df))
})
library(readxl)
library(dplyr)
library(purrr)
file <- "C:/Users/Rocchi/CMCC Dropbox/Paola Rocchi/PC/Desktop/work/Administrative/strategic_overview/output/strategic_overview.xlsx"
sheets <- excel_sheets(file)
info <- map_dfr(sheets, function(s) {
df <- tryCatch(
read_excel(file, sheet = s, n_max = 0),   # leggi solo intestazioni
error = function(e) NULL
)
if (is.null(df) || ncol(df) == 0) {
# nessuna colonna -> nessuna riga (ok)
tibble(sheet = character(0), column = character(0))
} else {
tibble(
sheet  = rep(s, ncol(df)),
column = names(df)
)
}
})
# Salva dettaglio (una riga per colonna)
write.csv(info, "excel_structure_detail.csv", row.names = FALSE)
# Salva sintesi (una riga per foglio con elenco colonne)
summary_by_sheet <- info %>%
group_by(sheet) %>%
summarise(columns = paste(column, collapse = ", "), .groups = "drop")
write.csv(summary_by_sheet, "excel_structure_by_sheet.csv", row.names = FALSE)
message("Fatto: creati 'excel_structure_detail.csv' e 'excel_structure_by_sheet.csv' nella working directory.")
View(summary_by_sheet)
info_types <- map_dfr(sheets, function(s) {
df <- tryCatch(read_excel(file, sheet = s, n_max = 100), error = function(e) NULL)
if (is.null(df) || ncol(df) == 0) {
tibble(sheet = character(0), column = character(0), type = character(0))
} else {
tibble(
sheet  = rep(s, ncol(df)),
column = names(df),
type   = vapply(df, function(x) paste(class(x), collapse = "/"), character(1))
)
}
})
write.csv(info_types, "excel_structure_with_types.csv", row.names = FALSE)
getwd()
devtools::document()
devtools::install(upgrade = "never", dependencies = FALSE, build_vignettes = FALSE)
library(fidelioDiagnostics)
cfg <- load_config()
launch_app("diagnostic")
launch_app("results")
res <- run_pipeline()
launch_app("diagnostic")
library(fidelioDiagnostics)
library(gdxrrw)
# Load configuration and print paths
cfg <- load_config()
launch_app("diagnostic")
res <- run_pipeline()
launch_app("results")
devtools::load_all()
launch_app("results")
devtools::install()
devtools::install(upgrade = "never")
library(fidelioDiagnostics)
library(gdxrrw)
# Load configuration and print paths
cfg <- load_config()
launch_app("diagnostic")
launch_app("results")
devtools::load_all()
launch_app("results")
launch_app("diagnostic")
library(fidelioDiagnostics)
library(gdxrrw)
# Load configuration and print paths
cfg <- load_config()
launch_app("diagnostic")
# 1) Where are we and what project does R see?
getwd()
list.files(pattern = "\\.Rproj$")
# 2) What do the relevant options/env vars say *before* anything else?
options(
"fidelioDiagnostics.config",
"fidelioDiagnostics.outputs",
"fidelio.project",
"fidelio.outputs"
)
Sys.getenv(c(
"FIDELIO_DIAG_CONFIG",
"FIDELIO_PROJECT",
"FIDELIO_OUTPUTS"
))
# 3) Load the package the way you normally do
library(fidelioDiagnostics)
fidelioDiagnostics::launch_app("diagnostic")
options(
fidelioDiagnostics.config = "C:/Users/Rocchi/Dropbox (CMCC)/PC/Documents/GitHub/fidelioDiagnostic/config/project.yml"
)
fidelioDiagnostics::launch_app("diagnostic")
library(fidelioDiagnostics)
cfg_path <- "C:/Users/Rocchi/Dropbox (CMCC)/PC/Documents/GitHub/fidelioDiagnostic/config/project.yml"
cfg <- fidelioDiagnostics:::load_config(cfg_path, verbose = TRUE)
names(cfg)
cfg$scenarios
library(fidelioDiagnostics)
app_file <- system.file("app", "diagnostic", "app.R", package = "fidelioDiagnostics")
app_file
# Show the first ~160 lines so we can see how .get_cfg() is defined there
readLines(app_file, n = 160)
library(fidelioDiagnostics)
cfg_path <- "C:/Users/Rocchi/Dropbox (CMCC)/PC/Documents/GitHub/fidelioDiagnostic/config/project.yml"
# 1) Load config *manually* (we know this works)
cfg <- fidelioDiagnostics:::load_config(cfg_path, verbose = TRUE)
# 2) Call scenario_cols *using this cfg explicitly*
fidelioDiagnostics:::scenario_cols(cfg)
getwd()
devtools::install()
library(fidelioDiagnostics)
options(
fidelioDiagnostics.config =
"C:/Users/Rocchi/Dropbox (CMCC)/PC/Documents/GitHub/fidelioDiagnostic/config/project.yml"
)
fidelioDiagnostics::launch_app("diagnostic")
library(fidelioDiagnostics)
options(
fidelioDiagnostics.config =
"C:/Users/Rocchi/Dropbox (CMCC)/PC/Documents/GitHub/fidelioDiagnostic/config/project.yml"
)
fidelioDiagnostics::launch_app("diagnostic")
traceback()
getAnywhere("base_scn")
getAnywhere("scenario_cols")
getAnywhere("policy_scns")
setwd("C:/Users/Rocchi/Dropbox (CMCC)/PC/Documents/GitHub/fidelioDiagnostic")
devtools::install(clean = TRUE, force = TRUE)
library(fidelioDiagnostics)
getAnywhere("base_scn")
getAnywhere("scenario_cols")
getAnywhere("policy_scns")
list.files("R", full.names = TRUE)
devtools::install(clean = TRUE, force = TRUE)
library(fidelioDiagnostics)
getAnywhere("base_scn")
getAnywhere("scenario_cols")
getAnywhere("policy_scns")
setwd("C:/Users/Rocchi/Dropbox (CMCC)/PC/Documents/GitHub/fidelioDiagnostic")
devtools::install(force = TRUE)
library(fidelioDiagnostics)
getAnywhere("base_scn")
getAnywhere("scenario_cols")
getAnywhere("policy_scns")
library(fidelioDiagnostics)
options(
fidelioDiagnostics.config =
"C:/Users/Rocchi/Dropbox (CMCC)/PC/Documents/GitHub/fidelioDiagnostic/config/project.yml"
)
fidelioDiagnostics::launch_app("diagnostic")
devtools::install(force = TRUE)
library(fidelioDiagnostics)
launch_app("diagnostic")
devtools::install(force = TRUE)
devtools::document()
library(fidelioDiagnostics)
library(gdxrrw)
# Load configuration and print paths
cfg <- load_config()
devtools::load_all()
cfg <- load_config()
launch_app("diagnostic")
library(fidelioDiagnostics)
library(gdxrrw)
# Load configuration and print paths
cfg <- load_config()
launch_app("diagnostic")
devtools::install()
library(fidelioDiagnostics)
library(gdxrrw)
# Load configuration and print paths
cfg <- load_config()
devtools::document()
devtools::install()
devtools::install()
devtools::document()
devtools::install()
library(fidelioDiagnostics)
library(gdxrrw)
# Load configuration and print paths
cfg <- load_config()
res <- run_pipeline()
launch_app("diagnostic")
devtools::install()
library(fidelioDiagnostics)
cfg <- load_config()
res <- run_pipeline()
launch_app("diagnostic")
library(fidelioDiagnostics)
cfg <- load_config()
res <- run_pipeline()
devtools::load_all()
devtools::load_all()
res <- run_pipeline()
devtools::load_all()
cfg <- load_config()
res <- run_pipeline()
devtools::load_all()
res <- run_pipeline()
devtools::load_all()
launch_app("diagnostic")
unique(BT_reg$c)
launch_app("diagnostic")
devtools::load_all()
cfg <- load_config()
res <- run_pipeline()
